<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Programa Actual - Radio Poder</title>
<link href="https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Saira Condensed', sans-serif;
    padding: 10px;
    margin: 0;
    background: transparent;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
  }
  .contenedor {
    background: rgba(38,38,38,0.8);
    border-radius: 8px;
    padding: 20px 30px;
    text-align: center;
    color: #a2c614;
    box-shadow: 0 0 15px rgba(0,0,0,0.4);
  }
  .titulo {
    font-size: 2rem;
    font-weight: 600;
    margin-bottom: 10px;
  }
  .horario {
    font-size: 1.2rem;
    color: #d1d1d1;
    margin-bottom: 8px;
  }
  .estado {
    color: #a2c614;
    font-size: 1rem;
    font-weight: 400;
  }
</style>
</head>
<body>
<div class="contenedor" id="programaActual">
  Cargando programa...
</div>

<script>
  const urlJson = 'https://tu-servidor.com/programacion-radio.json'; // reemplaza por tu URL real

  function getCurrentTimeGmtMinus5() {
    const now = new Date();
    const utc = now.getTime() + now.getTimezoneOffset() * 60000;
    return new Date(utc - 5 * 3600000);
  }

  function formatTime(date) {
    return date.toTimeString().slice(0,5);
  }

  function encuentraProgramaActual(programasDelDia, horaActualStr) {
    for (const programa of programasDelDia) {
      if (horaActualStr >= programa.inicio && horaActualStr < programa.fin) {
        return programa;
      }
    }
    return null;
  }

  async function actualizarPrograma() {
    try {
      const response = await fetch(urlJson);
      const data = await response.json();
      const diasSemana = ['domingo','lunes','martes','miercoles','jueves','viernes','sabado'];
      const fechaActual = getCurrentTimeGmtMinus5();
      const diaSemanaStr = diasSemana[fechaActual.getDay()];
      const horaActualStr = formatTime(fechaActual);
      const programasDelDia = data[diaSemanaStr];
      const programaActual = encuentraProgramaActual(programasDelDia, horaActualStr);

      const contenedor = document.getElementById('programaActual');
      if (programaActual) {
        contenedor.innerHTML = `
          <div class="titulo">${programaActual.programa}</div>
          <div class="horario">${programaActual.inicio} - ${programaActual.fin}</div>
          <div class="estado">Ahora en emisión</div>
        `;
      } else {
        contenedor.innerHTML = '<div class="titulo">Fuera de programación</div><div class="estado">Sin programa activo</div>';
      }
    } catch (error) {
      document.getElementById('programaActual').innerHTML = '<div class="titulo">Error</div><div class="estado">No se pudo cargar la programación</div>';
      console.error(error);
    }
  }

  actualizarPrograma();
  setInterval(actualizarPrograma, 60000);
</script>
</body>
</html>
